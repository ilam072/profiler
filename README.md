# Sum API Benchmark Project

## Описание проекта

Проект демонстрирует оптимизацию простого HTTP API для сложения чисел с помощью Go.
Цель — показать разницу в производительности между базовой реализацией с JSON POST и оптимизированной версией с GET-параметрами.

---

## Версии

### 1. Старая версия (POST + JSON)

* Метод: **POST**
* Принимает JSON тело с полями `a` и `b`.
* Использует `json.Decoder` и `json.Encoder`.
* Создаёт объекты `Req` и `Resp` на каждый запрос.

### 2. Улучшенная версия (GET + query)

* Метод: **GET**
* Параметры `a` и `b` берутся из query-параметров.
* Нет JSON декодирования тела запроса.
* Ответ формируется напрямую через `json.Marshal`.
* Меньше лишних аллокаций и быстрее CPU-выполнение.

---

## Бенчмарки

Запуск (из корня проекта):

```bash
go test -bench=. -benchmem ./internal/rest > benchmarks/old.txt

go test -bench=. -benchmem ./internal/rest > benchmarks/new.txt

benchstat old.txt new.txt
```

### Результаты

| Метрика     | Старая версия (POST + JSON) | Улучшенная версия (GET + query) | Разница              |
| ----------- | --------------------------- | ------------------------------- | -------------------- |
| `ns/op`     | 3519 ns                     | 3038 ns                         | ~14% быстрее         |
| `B/op`      | 7109 B                      | 7013 B                          | немного меньше (~1%) |
| `allocs/op` | 27                          | 27                              | без изменений        |

---

## Вывод

* Улучшенная версия быстрее по CPU за счёт отказа от JSON-декодирования и создания лишних структур.
* Память немного экономится, хотя количество аллокаций остаётся прежним.
* Проект демонстрирует подход “до/после” оптимизации с сохранением совместимого формата ответа в JSON.
